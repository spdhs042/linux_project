<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ğŸ“Š ìŠ¬ë¼ì´ë“œë³„ O/X í†µê³„ ë° ê·¸ë˜í”„</title>

  <!-- Chart.js ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸° (ê·¸ë˜í”„ ê·¸ë¦¬ê¸°ì— ì‚¬ìš©) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    /* ì „ì²´ ìŠ¬ë¼ì´ë“œ ë¸”ë¡ì„ ì¤‘ì•™ ì •ë ¬í•˜ê³  ì•„ë˜ìª½ ì—¬ë°± ì„¤ì • */
    .slide-container {
      display: flex;
      justify-content: center;
      margin-bottom: 40px;
    }

    /* í‘œ í…Œì´ë¸” ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
    table {
      border-collapse: collapse; /* ì…€ ê²½ê³„ ì¤‘ë³µ ì œê±° */
      width: auto;               /* ë‚´ìš©ì— ë”°ë¼ ë„ˆë¹„ ìë™ ì¡°ì ˆ */
      table-layout: fixed;       /* ê³ ì •ëœ í…Œì´ë¸” ë ˆì´ì•„ì›ƒ */
    }

    /* ì…€ ë‚´ë¶€ ì—¬ë°± ë° í…Œë‘ë¦¬, í…ìŠ¤íŠ¸ ì •ë ¬ */
    th, td {
      border: 1px solid #444;
      padding: 8px;
      text-align: center;
      vertical-align: top;
      height: 100%;
    }

    /* ì²« ë²ˆì§¸ ì—´(ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸+ì´ë¯¸ì§€) ë„ˆë¹„ ì„¤ì • */
    td:nth-child(1), th:nth-child(1) {
      width: 33vw;
      max-width: 300px;
    }

    /* ë‘ ë²ˆì§¸ ì—´(ê·¸ë˜í”„) ë„ˆë¹„ ì„¤ì • */
    td:nth-child(2), th:nth-child(2) {
      width: 250px;
    }

    /* ì…€ ë‚´ë¶€ë¥¼ ì„¸ë¡œ ë°©í–¥ìœ¼ë¡œ ì •ë ¬í•˜ê¸° ìœ„í•œ ë˜í¼ */
    .cell-wrapper {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
    }

    /* ìŠ¬ë¼ì´ë“œ ì´ë¯¸ì§€ ìŠ¤íƒ€ì¼ */
    td img {
      width: 100%;       /* ì…€ ë„ˆë¹„ì— ë§ì¶¤ */
      height: auto;      /* ë¹„ìœ¨ ìœ ì§€ */
      margin-top: 5px;   /* ì´ë¯¸ì§€ì™€ í…ìŠ¤íŠ¸ ì‚¬ì´ ì—¬ë°± */
      display: block;
    }

    /* ì°¨íŠ¸ ìº”ë²„ìŠ¤ í¬ê¸° ê³ ì • */
    td canvas {
      width: 220px !important;
      height: 120px !important;
      display: block;
    }
  </style>
</head>
<body>

  <!-- í˜ì´ì§€ ì œëª© -->
  <h2 style="text-align:center;">ğŸ“Š ìŠ¬ë¼ì´ë“œë³„ O/X í†µê³„ ë° ê·¸ë˜í”„</h2>

  <!-- ìŠ¬ë¼ì´ë“œë³„ í…Œì´ë¸” ë°˜ë³µ ë Œë”ë§ (Jinja2 í…œí”Œë¦¿ ë¬¸ë²• ì‚¬ìš©) -->
  {% for slide_idx, count in stats.items() %}
    <div class="slide-container">
      <table>
        <thead>
          <tr>
            <th>ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸</th>
            <th>ê·¸ë˜í”„</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>
              <!-- ìŠ¬ë¼ì´ë“œ ë²ˆí˜¸ ë° ì´ë¯¸ì§€ í‘œì‹œ -->
              <div class="cell-wrapper">
                {{ slide_idx }}<br />
                <img src="/static/slides/slide_{{ slide_idx }}.png" alt="ìŠ¬ë¼ì´ë“œ {{ slide_idx }} ì´ë¯¸ì§€" />
              </div>
            </td>
            <td>
              <!-- ì°¨íŠ¸ë¥¼ ê·¸ë¦´ ìº”ë²„ìŠ¤ ì˜ì—­ -->
              <div class="cell-wrapper">
                <canvas id="oxChart{{ slide_idx }}"></canvas>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  {% endfor %}

  <!-- ê° ìŠ¬ë¼ì´ë“œì— ëŒ€í•œ O/X ì‘ë‹µ ê·¸ë˜í”„ ìƒì„± ìŠ¤í¬ë¦½íŠ¸ -->
  <script>
    {% for slide_idx, count in stats.items() %}
      // í•´ë‹¹ ìŠ¬ë¼ì´ë“œì˜ ìº”ë²„ìŠ¤ ì»¨í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
      const ctx{{ slide_idx }} = document.getElementById('oxChart{{ slide_idx }}').getContext('2d');

      // ìƒˆë¡œìš´ ë°” ì°¨íŠ¸ ìƒì„±
      new Chart(ctx{{ slide_idx }}, {
        type: 'bar',  // ë°” ì°¨íŠ¸ í˜•ì‹
        data: {
          labels: ['â­•', 'âŒ'],  // ë¼ë²¨ (O, X)
          datasets: [{
            label: 'ìŠ¬ë¼ì´ë“œ {{ slide_idx }} ì‘ë‹µ',
            data: [{{ count.get('O', 0) }}, {{ count.get('X', 0) }}], // ì‘ë‹µ ìˆ˜ (ê¸°ë³¸ê°’ 0)
            backgroundColor: [
              'rgba(75, 192, 192, 0.7)',   // O ì‘ë‹µ ìƒ‰ìƒ
              'rgba(255, 99, 132, 0.7)'    // X ì‘ë‹µ ìƒ‰ìƒ
            ]
          }]
        },
        options: {
          responsive: false, // ë°˜ì‘í˜• ë¹„í™œì„±í™” (ê³ ì • í¬ê¸° ìœ ì§€)
          plugins: {
            legend: { display: false } // ë²”ë¡€ ì œê±°
          },
          scales: {
            y: {
              beginAtZero: true,    // Yì¶• 0ë¶€í„° ì‹œì‘
              ticks: { stepSize: 1 } // Yì¶• ê°„ê²© 1ë¡œ ì„¤ì •
            }
          }
        }
      });
    {% endfor %}
  </script>

</body>
</html>

